<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solicitud de Jornadas IPASME</title>
    <style>
        :root {
            --azul-oscuro: #004a99;
            --azul-claro: #e3f2fd;
            --verde-claro: #c8e6c9;
            --verde-boton: #4caf50;
            --blanco: #ffffff;
            --gris-suave: #f4f7f6;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--gris-suave);
            color: #333;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--blanco);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-top: 8px solid var(--azul-oscuro);
        }

        h1 { color: var(--azul-oscuro); text-align: center; }
        
        .aviso-48h {
            background-color: #fff3e0;
            border-left: 5px solid #ff9800;
            padding: 15px;
            margin-bottom: 25px;
            font-weight: bold;
            color: #e65100;
        }

        .section {
            margin-bottom: 25px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }

        h3 { margin-top: 0; color: var(--azul-oscuro); border-bottom: 2px solid var(--verde-claro); padding-bottom: 5px; }

        /* Estilo de Botones/Checkbox */
        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .option-item {
            position: relative;
        }

        .option-item input[type="checkbox"], 
        .option-item input[type="radio"] {
            display: none;
        }

        .option-item label {
            display: block;
            padding: 10px;
            background: var(--azul-claro);
            border: 2px solid transparent;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            transition: 0.3s;
            font-size: 0.9em;
        }

        .option-item input:checked + label {
            background: var(--verde-claro);
            border-color: var(--verde-boton);
            font-weight: bold;
        }

        /* Inputs de texto */
        input[type="text"], input[type="email"], input[type="date"], input[type="time"], select {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
        }

        .flex-row { display: flex; gap: 15px; flex-wrap: wrap; }
        .flex-item { flex: 1; min-width: 200px; }

        button[type="submit"] {
            background-color: var(--azul-oscuro);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            width: 100%;
            transition: background 0.3s;
        }

        button[type="submit"]:hover { background-color: #003366; }

        .hidden { display: none; }
    </style>
</head>
<body>

<div class="container">
    <h1>Solicitud de Jornada Institucional</h1>

    <div class="aviso-48h">
        ⚠️ IMPORTANTE: La solicitud no procederá a menos que tenga un mínimo de 48 horas de anticipación. Verifique su fecha antes de enviar.
    </div>

    <form id="jornadaForm" action="https://formsubmit.co/flyersunidadesipasme@gmail.com" method="POST">
        <input type="hidden" name="_subject" id="emailSubject" value="Nueva Solicitud de Jornada">
        <input type="hidden" name="_template" value="table">
        <input type="hidden" name="_next" value="https://tu-sitio.com/gracias.html">

        <div class="section">
            <h3>1. Tipo de Jornada</h3>
            <div class="options-grid">
                <div class="option-item">
                    <input type="radio" name="tipo_jornada" id="tj1" value="Ipasme va a la Escuela" required onclick="toggleMenu(this.value)">
                    <label for="tj1">Ipasme va a la Escuela</label>
                </div>
                <div class="option-item">
                    <input type="radio" name="tipo_jornada" id="tj2" value="Jornada de Atención Médica Integral" onclick="toggleMenu(this.value)">
                    <label for="tj2">Atención Médica Integral</label>
                </div>
                <div class="option-item">
                    <input type="radio" name="tipo_jornada" id="tj3" value="Jornada Conjunta" onclick="toggleMenu(this.value)">
                    <label for="tj3">Jornada Conjunta</label>
                </div>
                <div class="option-item">
                    <input type="radio" name="tipo_jornada" id="tj4" value="Captación Quirúrgica" onclick="toggleMenu(this.value)">
                    <label for="tj4">Captación Quirúrgica</label>
                </div>
            </div>
        </div>

        <div class="section" id="section-especialidades">
            <h3 id="label-especialidades">2. Especialidades (Seleccione una o varias)</h3>
            <div class="options-grid" id="container-especialidades">
                </div>
        </div>

        <div class="section" id="section-servicios">
            <h3>3. Servicios Adicionales</h3>
            <div class="options-grid">
                <div class="option-item"><input type="checkbox" name="servicios[]" id="s1" value="Fisioterapia"><label for="s1">Fisioterapia</label></div>
                <div class="option-item"><input type="checkbox" name="servicios[]" id="s2" value="Inmunización"><label for="s2">Inmunización</label></div>
                <div class="option-item"><input type="checkbox" name="servicios[]" id="s3" value="Control de talla y peso"><label for="s3">Control de talla y peso</label></div>
                <div class="option-item"><input type="checkbox" name="servicios[]" id="s4" value="Despistaje HTA"><label for="s4">Despistaje HTA</label></div>
                <div class="option-item"><input type="checkbox" name="servicios[]" id="s5" value="Afiliación"><label for="s5">Afiliación</label></div>
                <div class="option-item"><input type="checkbox" name="servicios[]" id="s6" value="Sesión educativa"><label for="s6">Sesión educativa</label></div>
                <div class="option-item"><input type="checkbox" name="servicios[]" id="s7" value="Farmacia"><label for="s7">Farmacia</label></div>
            </div>
        </div>

        <div class="section">
            <h3>4. Fecha y Hora</h3>
            <div class="flex-row">
                <div class="flex-item">
                    <label>Fecha del Evento:</label>
                    <input type="date" name="fecha_evento" id="fecha_evento" required onchange="validar48Horas()">
                </div>
                <div class="flex-item">
                    <label>Hora:</label>
                    <div style="display: flex; gap: 5px;">
                        <input type="time" name="hora_evento" required>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h3>Datos de Contacto y Ubicación</h3>
            <label>5. Dirección Exacta:</label>
            <input type="text" name="direccion" placeholder="Ej: Calle 4 con Av. Principal..." required>
            
            <label>6. Unidad IPASME Solicitante:</label>
            <input type="text" name="unidad" id="unidad_nombre" placeholder="Nombre de la unidad" required oninput="actualizarAsunto()">

            <label>7. Teléfono del solicitante:</label>
            <input type="text" name="telefono" placeholder="Ej: 0412-1234567" required>

            <label>8. Correo para enviar el arte (Flyer):</label>
            <input type="email" name="email_contacto" placeholder="correo@ejemplo.com" required>
        </div>

        <button type="submit" id="btnEnviar">ENVIAR SOLICITUD</button>
    </form>
</div>

<script>
    const especialidades = ["Alergología", "Cardiología", "Cirugía General", "Dermatología", "Ecografía", "Fisiatría", "Gastroenterología", "Geriatría", "Gerontología", "Ginecología y Obstetricia", "Medicina Familiar y Comunitaria", "Medicina General", "Medicina Intensiva", "Medicina Interna", "Nefrología", "Neumología", "Neurología", "Nutrición", "Odontología", "Oftalmología", "Oncología Médica", "Optometría", "Pediatría", "Psicología", "Psiquiatría", "Reumatología", "Traumatología", "Urología"];
    
    const patologias = ["Hernia Inguinal", "Hernia Umbilical", "Hernia Abdominal", "Hernia Epigástrica", "Hernia Escrotal", "Fimosis", "Varicocele", "Hidrocele", "Litiasis Vesicular", "Colectomía", "Lipomas", "Quiste Tirogloso", "Quiste sebáceo", "Esterilización", "Miomatosis Uterina", "Tumores Ováricos", "Prolapso", "Histerectomía", "Catarata", "Pterigión", "Glaucoma", "Retinoblastoma"];

    function renderOptions(lista, name) {
        const container = document.getElementById('container-especialidades');
        container.innerHTML = '';
        lista.forEach((item, index) => {
            const div = document.createElement('div');
            div.className = 'option-item';
            div.innerHTML = `
                <input type="checkbox" name="${name}[]" id="opt${index}" value="${item}">
                <label for="opt${index}">${item}</label>
            `;
            container.appendChild(div);
        });
    }

    function toggleMenu(tipo) {
        const labelEspec = document.getElementById('label-especialidades');
        const sectionServicios = document.getElementById('section-servicios');
        
        if (tipo === 'Captación Quirúrgica') {
            labelEspec.innerText = "2. Patologías (Seleccione una o varias)";
            sectionServicios.classList.add('hidden');
            renderOptions(patologias, 'patologias');
        } else {
            labelEspec.innerText = "2. Especialidades (Seleccione una o varias)";
            sectionServicios.classList.remove('hidden');
            renderOptions(especialidades, 'especialidades');
        }
        actualizarAsunto();
    }

    function validar48Horas() {
        const inputFecha = document.getElementById('fecha_evento').value;
        if (!inputFecha) return;

        const fechaSeleccionada = new Date(inputFecha + "T00:00:00");
        const hoy = new Date();
        const limite = new Date();
        limite.setHours(hoy.getHours() + 48);

        if (fechaSeleccionada < limite) {
            alert("⚠️ La solicitud no puede procesarse. Debe tener al menos 48 horas de anticipación.");
            document.getElementById('fecha_evento').value = "";
        }
    }

    function actualizarAsunto() {
        const unidad = document.getElementById('unidad_nombre').value || "Unidad";
        const tipoInput = document.querySelector('input[name="tipo_jornada"]:checked');
        const tipo = tipoInput ? tipoInput.value : "";
        document.getElementById('emailSubject').value = `Solicitud: ${unidad} - ${tipo}`;
    }

    // Inicializar con especialidades
    renderOptions(especialidades, 'especialidades');

    // Validación extra al enviar
    document.getElementById('jornadaForm').onsubmit = function(e) {
        const checks = document.querySelectorAll('#container-especialidades input[type="checkbox"]:checked');
        if (checks.length === 0) {
            alert("Por favor seleccione al menos una Especialidad/Patología");
            e.preventDefault();
            return false;
        }
    };
</script>

</body>
</html>
